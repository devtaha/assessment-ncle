<form [formGroup]="form" class="space-y-6" (ngSubmit)="onSubmit()">
  <div>
    <label class="block text-sm font-semibold text-gray-900"><span class="text-[#C22207]">*</span> Title</label>
    <input formControlName="title" type="text" placeholder="Add title of exam" class="mt-2 w-full rounded-2xl border border-gray-200 bg-white px-4 py-3 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary" />
    <div *ngIf="form.get('title')?.touched && form.get('title')?.invalid" class="mt-1 text-sm text-[#C22207]">Title is required.</div>
  </div>

  <div>
    <label class="block text-sm font-semibold text-gray-900"><span class="text-[#C22207]">*</span> Description</label>
    <textarea formControlName="description" rows="3" placeholder="Exam description" class="mt-2 w-full rounded-2xl border border-gray-200 bg-white px-4 py-3 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary"></textarea>
    <div class="text-right text-sm text-gray-400">{{ (form.get('description')?.value?.length || 0) }}/500</div>
    <div *ngIf="form.get('description')?.touched && form.get('description')?.invalid" class="mt-1 text-sm text-[#C22207]">Description is required (max 500 chars).</div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <div>
      <label class="block text-sm font-semibold text-gray-900"><span class="text-[#C22207]">*</span> Start date</label>
      <div class="mt-2 flex items-center gap-2 rounded-2xl border border-gray-200 bg-white px-4 py-3">
        <input formControlName="startDate" type="date" class="w-full bg-transparent focus:outline-none" />
      </div>
      <div *ngIf="form.get('startDate')?.touched && form.get('startDate')?.invalid" class="mt-1 text-sm text-[#C22207]">Start date is required.</div>
    </div>
    <div>
      <label class="block text-sm font-semibold text-gray-900"><span class="text-[#C22207]">*</span> Start time</label>
      <div class="mt-2 flex items-center gap-2 rounded-2xl border border-gray-200 bg-white px-4 py-3">
        <input formControlName="startTime" type="time" class="w-full bg-transparent focus:outline-none" />
      </div>
      <div *ngIf="form.get('startTime')?.touched && form.get('startTime')?.invalid" class="mt-1 text-sm text-[#C22207]">Start time is required.</div>
    </div>
    <div>
      <label class="block text-sm font-semibold text-gray-900"><span class="text-[#C22207]">*</span> Due date</label>
      <div class="mt-2 flex items-center gap-2 rounded-2xl border border-gray-200 bg-white px-4 py-3">
        <input formControlName="dueDate" type="date" class="w-full bg-transparent focus:outline-none" />
      </div>
      <div *ngIf="form.get('dueDate')?.touched && form.get('dueDate')?.invalid" class="mt-1 text-sm text-[#C22207]">Due date is required.</div>
    </div>
    <div>
      <label class="block text-sm font-semibold text-gray-900"><span class="text-[#C22207]">*</span> Due time</label>
      <div class="mt-2 flex items-center gap-2 rounded-2xl border border-gray-200 bg-white px-4 py-3">
        <input formControlName="dueTime" type="time" class="w-full bg-transparent focus:outline-none" />
      </div>
      <div *ngIf="form.get('dueTime')?.touched && form.get('dueTime')?.invalid" class="mt-1 text-sm text-[#C22207]">Due time is required.</div>
    </div>
  </div>

  <div>
    <label class="block text-sm font-semibold text-gray-900"><span class="text-[#C22207]">*</span> Duration</label>
    <input formControlName="duration" type="text" placeholder="e.g 30 min" class="mt-2 w-full rounded-2xl border border-gray-200 bg-white px-4 py-3 text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary" />
    <div *ngIf="form.get('duration')?.touched && form.get('duration')?.invalid" class="mt-1 text-sm text-[#C22207]">Duration is required.</div>
  </div>

  <div>
    <label class="block text-sm font-semibold text-gray-900"><span class="text-[#C22207]">*</span> No of attempt</label>
    <div class="mt-2 flex flex-wrap gap-2">
      <button type="button" *ngFor="let n of attemptsOptions; trackBy: trackByNumber"
        (click)="selectAttempts(n)"
        [class]="'px-4 py-2 rounded-xl border text-sm font-medium ' + (form.get('attempts')?.value===n ? 'bg-primary border-primary text-gray-900' : 'bg-white border-gray-200 text-gray-700')">
        {{ n }}
      </button>
    </div>
  </div>

  <div>
    <label class="block text-sm font-semibold text-gray-900"><span class="text-[#C22207]">*</span> View Correct Answer</label>
    <div class="mt-2 flex items-center gap-3">
      <button type="button"
        (click)="selectViewCorrectAnswer('yes')"
        [class]="'inline-flex items-center gap-2 px-4 py-2 rounded-xl border cursor-pointer ' + (form.get('viewCorrectAnswer')?.value === 'yes' ? 'bg-[#FED143] border-[#FED143] text-gray-900' : 'border-gray-200 bg-white text-gray-700')">
        <span>Yes</span>
      </button>
      <button type="button"
        (click)="selectViewCorrectAnswer('no')"
        [class]="'inline-flex items-center gap-2 px-4 py-2 rounded-xl border cursor-pointer ' + (form.get('viewCorrectAnswer')?.value === 'no' ? 'bg-[#FED143] border-[#FED143] text-gray-900' : 'border-gray-200 bg-white text-gray-700')">
        <span>No</span>
      </button>
    </div>
  </div>

  <!-- Date Range Validation Error -->
  <div *ngIf="dateRangeError && (form.get('startDate')?.touched || form.get('dueDate')?.touched)"
       class="mt-4 p-3 rounded-lg bg-red-50 border border-red-200">
    <p class="text-sm text-red-600 flex items-center">
      <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20">
        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
      </svg>
      {{ dateRangeError }}
    </p>
  </div>

  <div class="flex md:justify-end">
    <button type="submit" class="w-full md:w-auto px-6 py-3 rounded-2xl bg-primary hover:bg-primary-hover font-extrabold text-gray-900">Create</button>
  </div>
</form>


